pca1 <- princomp(xyz_long[,3:5], cor=T) #scale differences T
summary(pca1, loadings=T)
xyz_long_uni <- xyz_long_uni %>% mutate(X = 0.209*X + 0.723*Y + 0.658*Z) %>% select(-Y, -Z)
xyz_long_uni <- xyz_long %>% mutate(X = 0.209*X + 0.723*Y + 0.658*Z) %>% select(-Y, -Z)
View(xyz_long_uni)
pca1$scores[,1]
xyz_long_uni <- xyz_long %>% mutate(X = 0.209*X + 0.723*Y + 0.658*Z, pca=pca1$scores[,1]) %>% select(-Y, -Z)
pca1
View(pca1)
help(princomp)
xyz_long_uni <- xyz_long %>% mutate(X = 0.209*X + 0.723*Y + 0.658*Z) %>% select(-Y, -Z)
xyz_long_uni <- xyz_long %>% mutate(X = 0.209*X + 0.723*Y + 0.658*Z) %>% select(-Y, -Z) %>% group_by(class)
xyz_long_uni <- xyz_long %>% mutate(X = 0.209*X + 0.723*Y + 0.658*Z) %>% select(-Y, -Z)
ex1 <- xyz_long_uni %>% filter(class==1, time_series_id==1)
View(ex1)
ex1 <- xyz_long_uni %>% filter(time_series_id==1)
ex2 <- xyz_long_uni %>% filter(time_series_id==2)
View(ex2)
ex_class_1 <- xyz_long_uni %>% filter(time_series_id==3)
View(ex_class_1)
xyz_long_uni %>% filter(time_series_id==4)
xyz_long_uni %>% filter(time_series_id==5)
xyz_long_uni %>% filter(time_series_id==6)
xyz_long_uni %>% filter(time_series_id==7)
xyz_long_uni %>% filter(time_series_id==8)
xyz_long_uni %>% filter(time_series_id==9)
xyz_long_uni %>% filter(time_series_id==10)
xyz_long_uni %>% filter(time_series_id==11)
xyz_long_uni %>% filter(time_series_id==2)
xyz_long_uni %>% filter(time_series_id==12)
xyz_long_uni %>% filter(time_series_id==13)
xyz_long_uni %>% filter(time_series_id==14)
xyz_long_uni %>% filter(time_series_id==15)
xyz_long_uni %>% filter(time_series_id==15)
xyz_long_uni %>% filter(time_series_id==16)
xyz_long_uni %>% filter(time_series_id==17)
xyz_long_uni %>% filter(time_series_id==18)
xyz_long_uni %>% filter(time_series_id==19)
xyz_long_uni %>% filter(time_series_id==10)
xyz_long_uni %>% filter(time_series_id==20)
xyz_long_uni %>% filter(time_series_id==10)
xyz_long_uni %>% filter(time_series_id==20)
xyz_long_uni %>% filter(time_series_id==21)
ex_class1 <- xyz_long_uni %>% filter(time_series_id==11 | time_series_id==17)
View(ex_class1)
ex_class1 <- xyz_long_uni %>% filter(time_series_id==11 | time_series_id==17)
ex_class2 <- xyz_long_uni %>% filter(time_series_id==15 | time_series_id==20)
ex_class3 <- xyz_long_uni %>% filter(time_series_id==4 | time_series_id==13)
ex_class4 <- xyz_long_uni %>% filter(time_series_id==5 | time_series_id==8)
ex_class5 <- xyz_long_uni %>% filter(time_series_id==2 | time_series_id==3)
ex_class6 <- xyz_long_uni %>% filter(time_series_id==1 | time_series_id==10)
ex_class7 <- xyz_long_uni %>% filter(time_series_id==7 | time_series_id==12)
ex_class8 <- xyz_long_uni %>% filter(time_series_id==6 | time_series_id==21)
View(ex_class1)
ggplot(data=ex_class1,
aes(x=time_index, y=X, colour=time_series_id)) + geom_line()
ggplot(data=ex_class1, aes(x=time_index, y=X, colour=time_series_id)) + geom_line()
ggplot(data=ex_class1, aes(x=time_index, y=X, colour=time_series_id)) + geom_line()
ggplot(data=ex_class1, aes(x=time_index)) + geom_line(aes(y=X, colour = "time_series_id"))
ggplot(data=ex_class1, aes(x=time_index)) + geom_line(aes(y=X))
xyz_long_uni <- xyz_long %>% mutate(value = 0.209*X + 0.723*Y + 0.658*Z) %>% select(-X, -Y, -Z)
ex_class1 <- xyz_long_uni %>% filter(time_series_id==11 | time_series_id==17)
ex_class2 <- xyz_long_uni %>% filter(time_series_id==15 | time_series_id==20)
ex_class3 <- xyz_long_uni %>% filter(time_series_id==4 | time_series_id==13)
ex_class4 <- xyz_long_uni %>% filter(time_series_id==5 | time_series_id==8)
ex_class5 <- xyz_long_uni %>% filter(time_series_id==2 | time_series_id==3)
ex_class6 <- xyz_long_uni %>% filter(time_series_id==1 | time_series_id==10)
ex_class7 <- xyz_long_uni %>% filter(time_series_id==7 | time_series_id==12)
ex_class8 <- xyz_long_uni %>% filter(time_series_id==6 | time_series_id==21)
ggplot(data=ex_class1, aes(x=time_index, y=value, color= time_series_id))
ggplot(data=ex_class1, aes(x=time_index, y=value, color= time_series_id)) + geom_line()
ggplot(data=ex_class1, aes(x=time_index, y=value, color= time_series_id)) + geom_point()
ggplot(data=ex_class1, aes(x=time_index, y=value, color= time_series_id)) + geom_point() + xlab("Time Index") + ylab("Value") + theme(plot.title=element_text(hjust = 0.5)) + ggtitle("Value vs Time Index")
ggplot() + geom_line(ex_class1_1, aes(x=time_index, y=value))
ex_class1_1 %>% filter(time_series_id==11)
ex_class1_1 %>% filter(time_series_id==11)
ex_class1_1 <- ex_class1 %>% filter(time_series_id==11)
ex_class1_2 <- ex_class1 %>% filter(time_series_id==17)
ggplot() + geom_line(ex_class1_1, aes(x=time_index, y=value))
ggplot(ex_class1_1) + geom_line(aes(x=time_index, y=value))
ex_class1 <- ex_class1 %>% group_by(time_series_id)
ggplot(ex_class1) + geom_line(aes(x=time_index, y=value))
ggplot(ex_class1) + geom_line(aes(x=time_index, y=value, colour=time_series_id))
ggplot(ex_class1, aes(x=time_index, y=value, colour=time_series_id)) + geom_line()
ggplot(ex_class1) + geom_line(aes(x=time_index, y=value, colour=time_series_id))
ex_class1$time_series_id <- as_factor(ex_class1$time_series_id)
ggplot(ex_class1) + geom_line(aes(x=time_index, y=value, colour=time_series_id))
ex_class1 <- xyz_long_uni %>% filter(time_series_id==11 | time_series_id==17) %>% mutate(time_series_id = as_faxtor(time_series_id))
ex_class1 <- xyz_long_uni %>% filter(time_series_id==11 | time_series_id==17) %>% mutate(time_series_id = as_factor(time_series_id))
ex_class1 <- xyz_long_uni %>% filter(time_series_id==11 | time_series_id==17) %>% mutate(time_series_id = as_factor(time_series_id))
ex_class2 <- xyz_long_uni %>% filter(time_series_id==15 | time_series_id==20) %>% mutate(time_series_id = as_factor(time_series_id))
ex_class3 <- xyz_long_uni %>% filter(time_series_id==4 | time_series_id==13) %>% mutate(time_series_id = as_factor(time_series_id))
ex_class4 <- xyz_long_uni %>% filter(time_series_id==5 | time_series_id==8) %>% mutate(time_series_id = as_factor(time_series_id))
ex_class5 <- xyz_long_uni %>% filter(time_series_id==2 | time_series_id==3) %>% mutate(time_series_id = as_factor(time_series_id))
ex_class6 <- xyz_long_uni %>% filter(time_series_id==1 | time_series_id==10) %>% mutate(time_series_id = as_factor(time_series_id))
ex_class7 <- xyz_long_uni %>% filter(time_series_id==7 | time_series_id==12) %>% mutate(time_series_id = as_factor(time_series_id))
ex_class8 <- xyz_long_uni %>% filter(time_series_id==6 | time_series_id==21) %>% mutate(time_series_id = as_factor(time_series_id))
ggplot(ex_class1) + geom_line(aes(x=time_index, y=value, colour=time_series_id)) + xlab("Time Index") + ylab("Value") + theme(plot.title=element_text(hjust = 0.5)) + ggtitle("Value vs Time Index")
ggplot(ex_class1) + geom_line(aes(x=time_index, y=value, colour=time_series_id)) + xlab("Time Index") + ylab("Value") + theme(plot.title=element_text(hjust = 0.5)) + ggtitle("2 Time Series from Class 1")
ggplot(ex_class2) + geom_line(aes(x=time_index, y=value, colour=time_series_id)) + xlab("Time Index") + ylab("Value") + theme(plot.title=element_text(hjust = 0.5)) + ggtitle("2 Time Series from Class 2")
ggplot(ex_class3) + geom_line(aes(x=time_index, y=value, colour=time_series_id)) + xlab("Time Index") + ylab("Value") + theme(plot.title=element_text(hjust = 0.5)) + ggtitle("2 Time Series from Class 3")
ggplot(ex_class4) + geom_line(aes(x=time_index, y=value, colour=time_series_id)) + xlab("Time Index") + ylab("Value") + theme(plot.title=element_text(hjust = 0.5)) + ggtitle("2 Time Series from Class 4")
ggplot(ex_class5) + geom_line(aes(x=time_index, y=value, colour=time_series_id)) + xlab("Time Index") + ylab("Value") + theme(plot.title=element_text(hjust = 0.5)) + ggtitle("2 Time Series from Class 5")
ggplot(ex_class6) + geom_line(aes(x=time_index, y=value, colour=time_series_id)) + xlab("Time Index") + ylab("Value") + theme(plot.title=element_text(hjust = 0.5)) + ggtitle("2 Time Series from Class 6")
ggplot(ex_class7) + geom_line(aes(x=time_index, y=value, colour=time_series_id)) + xlab("Time Index") + ylab("Value") + theme(plot.title=element_text(hjust = 0.5)) + ggtitle("2 Time Series from Class 7")
ggplot(ex_class8) + geom_line(aes(x=time_index, y=value, colour=time_series_id)) + xlab("Time Index") + ylab("Value") + theme(plot.title=element_text(hjust = 0.5)) + ggtitle("2 Time Series from Class 8")
xyz_long_1 <- xyz_long %>% filter(class==1)
pca1 <- princomp(xyz_long_1[,3:5], cor=T) #scale differences T
summary(pca1, loadings=T)
xyz_long_1 <- xyz_long %>% filter(class==1)
pca1 <- princomp(xyz_long_1[,3:5], cor=T) #scale differences T
summary(pca1, loadings=T)
xyz_long_uni_1 <- xyz_long_1 %>% mutate(value = 0.119*X + 0.693*Y + 0.711*Z) %>% select(-X, -Y, -Z)
View(xyz_long_uni_1)
ex_class1_1 <- xyz_long_uni_1 %>% filter(time_series_id==11 | time_series_id==17) %>% mutate(time_series_id = as_factor(time_series_id))
View(ex_class1_1)
ggplot(ex_class1_1) + geom_line(aes(x=time_index, y=value, colour=time_series_id)) + xlab("Time Index") + ylab("Value") + theme(plot.title=element_text(hjust = 0.5)) + ggtitle("2 Time Series from Class 1")
xyz_long_2 <- xyz_long %>% filter(class==2)
pca2 <- princomp(xyz_long_1[,3:5], cor=T) #scale differences T
summary(pca2, loadings=T)
xyz_long_2 <- xyz_long %>% filter(class==2)
pca2 <- princomp(xyz_long_2[,3:5], cor=T) #scale differences T
summary(pca2, loadings=T)
xyz_long_uni_2 <- xyz_long_2 %>% mutate(value = 0.535*X + 0.613*Y + 0.581*Z) %>% select(-X, -Y, -Z)
ex_class2_2 <- xyz_long_uni_2 %>% filter(time_series_id==15 | time_series_id==20) %>% mutate(time_series_id = as_factor(time_series_id))
ggplot(ex_class2_2) + geom_line(aes(x=time_index, y=value, colour=time_series_id)) + xlab("Time Index") + ylab("Value") + theme(plot.title=element_text(hjust = 0.5)) + ggtitle("2 Time Series from Class 2")
xyz_long_3 <- xyz_long %>% filter(class==3)
pca3 <- princomp(xyz_long_3[,3:5], cor=T) #scale differences T
summary(pca3, loadings=T)
xyz_long_uni_3 <- xyz_long_3 %>% mutate(value = 0.709*X + 0.371*Y -0.599*Z) %>% select(-X, -Y, -Z)
ex_class3_3 <- xyz_long_uni_3 %>% filter(time_series_id==4 | time_series_id==13) %>% mutate(time_series_id = as_factor(time_series_id))
ggplot(ex_class2_2) + geom_line(aes(x=time_index, y=value, colour=time_series_id)) + xlab("Time Index") + ylab("Value") + theme(plot.title=element_text(hjust = 0.5)) + ggtitle("2 Time Series from Class 3")
ggplot(ex_class3_3) + geom_line(aes(x=time_index, y=value, colour=time_series_id)) + xlab("Time Index") + ylab("Value") + theme(plot.title=element_text(hjust = 0.5)) + ggtitle("2 Time Series from Class 3")
pca <- princomp(xyz_long[,3:5], cor=T) #scale differences T
print(summary(pca, loadings=T))
xyz_long_4 <- xyz_long %>% filter(class==4)
pca4 <- princomp(xyz_long_4[,3:5], cor=T) #scale differences T
print(summary(pca4, loadings=T))
xyz_long_uni_4 <- xyz_long_4 %>% mutate(value = 0.702*X + 0.679*Y -0.230*Z) %>% select(-X, -Y, -Z)
ex_class4_4 <- xyz_long_uni_4 %>% filter(time_series_id==5 | time_series_id==8) %>% mutate(time_series_id = as_factor(time_series_id))
ggplot(ex_class4_4) + geom_line(aes(x=time_index, y=value, colour=time_series_id)) + xlab("Time Index") + ylab("Value") + theme(plot.title=element_text(hjust = 0.5)) + ggtitle("2 Time Series from Class 4")
xyz_long_5 <- xyz_long %>% filter(class==5)
pca5 <- princomp(xyz_long_5[,3:5], cor=T) #scale differences T
print(summary(pca5, loadings=T))
xyz_long_uni_5 <- xyz_long_5 %>% mutate(value = 0.245*X + 0.685*Y + 0.686*Z) %>% select(-X, -Y, -Z)
ex_class5_5 <- xyz_long_uni_5 %>% filter(time_series_id==2 | time_series_id==3) %>% mutate(time_series_id = as_factor(time_series_id))
ggplot(ex_class5_5) + geom_line(aes(x=time_index, y=value, colour=time_series_id)) + xlab("Time Index") + ylab("Value") + theme(plot.title=element_text(hjust = 0.5)) + ggtitle("2 Time Series from Class 4")
xyz_long_6 <- xyz_long %>% filter(class==6)
pca6 <- princomp(xyz_long_6[,3:5], cor=T) #scale differences T
print(summary(pca6, loadings=T))
ex_class6_6 <- xyz_long_uni_6 %>% filter(time_series_id==1 | time_series_id==10) %>% mutate(time_series_id = as_factor(time_series_id))
xyz_long_uni_6 <- xyz_long_6 %>% mutate(value = 0.291*X - 0.671*Y - 0.682*Z) %>% select(-X, -Y, -Z)
ex_class6_6 <- xyz_long_uni_6 %>% filter(time_series_id==1 | time_series_id==10) %>% mutate(time_series_id = as_factor(time_series_id))
ggplot(ex_class6_6) + geom_line(aes(x=time_index, y=value, colour=time_series_id)) + xlab("Time Index") + ylab("Value") + theme(plot.title=element_text(hjust = 0.5)) + ggtitle("2 Time Series from Class 6")
xyz_long_7 <- xyz_long %>% filter(class==7)
pca7 <- princomp(xyz_long_7[,3:5], cor=T) #scale differences T
print(summary(pca7, loadings=T))
xyz_long_uni_7 <- xyz_long_7 %>% mutate(value = 0.596*X + 0.632*Y + 0.496*Z) %>% select(-X, -Y, -Z)
ex_class7_7 <- xyz_long_uni_7 %>% filter(time_series_id==7 | time_series_id==12) %>% mutate(time_series_id = as_factor(time_series_id))
ggplot(ex_class7_7) + geom_line(aes(x=time_index, y=value, colour=time_series_id)) + xlab("Time Index") + ylab("Value") + theme(plot.title=element_text(hjust = 0.5)) + ggtitle("2 Time Series from Class 7")
xyz_long_8 <- xyz_long %>% filter(class==8)
pca8 <- princomp(xyz_long_8[,3:5], cor=T) #scale differences T
print(summary(pca8, loadings=T))
xyz_long_8 <- xyz_long %>% filter(class==8)
pca8 <- princomp(xyz_long_8[,3:5], cor=T) #scale differences T
print(summary(pca8, loadings=T))
xyz_long_uni_8 <- xyz_long_8 %>% mutate(value = 0.664*X + 0.337*Y + 0.668*Z) %>% select(-X, -Y, -Z)
ex_class8_8 <- xyz_long_uni_8 %>% filter(time_series_id==6 | time_series_id==21) %>% mutate(time_series_id = as_factor(time_series_id))
ggplot(ex_class8_8) + geom_line(aes(x=time_index, y=value, colour=time_series_id)) + xlab("Time Index") + ylab("Value") + theme(plot.title=element_text(hjust = 0.5)) + ggtitle("2 Time Series from Class 8")
ex_class <- xyz_long_uni %>% filter(time_series_id %in% c(11, 17, 15, 20, 4, 13, 5, 8, 2, 3, 1, 10, 7, 12, 6, 21))
View(ex_class)
ex_class <- xyz_long_uni %>% filter(time_series_id %in% c(11, 17, 15, 20, 4, 13, 5, 8, 2, 3, 1, 10, 7, 12, 6, 21)) %>% mutate(time_series_id = as_factor(time_series_id), class = as_factor(class))
ggplot(ex_class) + geom_line(aes(x=time_index, y=value, colour=class)) + xlab("Time Index") + ylab("Value") + theme(plot.title=element_text(hjust = 0.5)) + ggtitle("2 Time Series from Each Class")
ggplot(ex_class) + geom_line(aes(x=time_index, y=value, colour=time_series_id)) + xlab("Time Index") + ylab("Value") + theme(plot.title=element_text(hjust = 0.5)) + ggtitle("2 Time Series from Each Class")
ggplot(ex_class) + geom_point(aes(x=time_index, y=value, colour=class)) + xlab("Time Index") + ylab("Value") + theme(plot.title=element_text(hjust = 0.5)) + ggtitle("2 Time Series from Each Class")
ggplot(ex_class) + geom_line(aes(x=time_index, y=value, colour=class)) + xlab("Time Index") + ylab("Value") + theme(plot.title=element_text(hjust = 0.5)) + ggtitle("2 Time Series from Each Class")
ex_class <- xyz_long_uni %>% filter(time_series_id %in% c(11, 17, 15, 20, 4, 13, 5, 8, 2, 3, 1, 10, 7, 12, 6, 21)) %>% mutate(class = as_factor(class))
ggplot(ex_class) + geom_line(aes(x=time_index, y=value, colour=class)) + xlab("Time Index") + ylab("Value") + theme(plot.title=element_text(hjust = 0.5)) + ggtitle("2 Time Series from Each Class")
ggplot(ex_class) + geom_line(aes(x=time_index, y=value, colour=time_series_id)) + xlab("Time Index") + ylab("Value") + theme(plot.title=element_text(hjust = 0.5)) + ggtitle("2 Time Series from Each Class")
ex_class <- xyz_long_uni %>% filter(time_series_id %in% c(11, 17, 15, 20, 4, 13, 5, 8, 2, 3, 1, 10, 7, 12, 6, 21)) %>% mutate(time_series_id = as_factor(time_series_id), class = as_factor(class))
ggplot(ex_class) + geom_line(aes(x=time_index, y=value, colour=time_series_id)) + xlab("Time Index") + ylab("Value") + theme(plot.title=element_text(hjust = 0.5)) + ggtitle("2 Time Series from Each Class")
ggplot(ex_class) + geom_line(aes(x=time_index, y=value, colour=time_series_id)) + xlab("Time Index") + ylab("Value") + theme(plot.title=element_text(hjust = 0.5)) + scale_fill_discrete(name = "Classes", labels = c("Class6", "Class5", "Class5"))
ggplot(ex_class) + geom_line(aes(x=time_index, y=value, colour=time_series_id)) + xlab("Time Index") + ylab("Value") + theme(plot.title=element_text(hjust = 0.5)) + scale_fill_discrete(name = "Classes", labels = c("Class6", "Class5", "Class5"))
ggplot(ex_class) + geom_line(aes(x=time_index, y=value, colour=time_series_id)) + xlab("Time Index") + ylab("Value") + theme(plot.title=element_text(hjust = 0.5)) + scale_color_discrete(name = "Classes", labels = c("Class6", "Class5", "Class5", "Class3", "Class4", "Class8", "Class7", "Class4", "Class6", "Class1", "Class7", "Class3", "Class2", "Class1", "Class2", "Class8"))
ggplot(ex_class) + geom_line(aes(x=time_index, y=value, colour=time_series_id)) + xlab("Time Index") + ylab("Value") + theme(plot.title=element_text(hjust = 0.5)) + scale_color_discrete(name = "Classes", labels = c("Class6", "Class5", "Class5", "Class3", "Class4", "Class8", "Class7", "Class4", "Class6", "Class1", "Class7", "Class3", "Class2", "Class1", "Class2", "Class8")) + guides(colour = guide_legend(nrow = 1))
ggplot(ex_class) + geom_line(aes(x=time_index, y=value, colour=time_series_id)) + xlab("Time Index") + ylab("Value") + theme(plot.title=element_text(hjust = 0.5)) + scale_color_discrete(name = "Classes", labels = c("Class6", "Class5", "Class5", "Class3", "Class4", "Class8", "Class7", "Class4", "Class6", "Class1", "Class7", "Class3", "Class2", "Class1", "Class2", "Class8"))
p <- ggplot(ex_class) + geom_line(aes(x=time_index, y=value, colour=time_series_id)) + xlab("Time Index") + ylab("Value") + theme(plot.title=element_text(hjust = 0.5)) + scale_color_discrete(name = "Classes", labels = c("Class6", "Class5", "Class5", "Class3", "Class4", "Class8", "Class7", "Class4", "Class6", "Class1", "Class7", "Class3", "Class2", "Class1", "Class2", "Class8"))
gt <- ggplotGrob(p)
gt <- ggplotGrob(p)
gt$layout$clip[gt$layout$name == "panel"] <- "off"
grid.draw(gt)
library(grid)
gt <- ggplotGrob(p)
gt$layout$clip[gt$layout$name == "panel"] <- "off"
grid.draw(gt)
library(directlabels)
install.packages("directlabels")
library(directlabels)
ggplot(ex_class) + geom_line(aes(x=time_index, y=value, colour=time_series_id)) + xlab("Time Index") + ylab("Value") + theme(plot.title=element_text(hjust = 0.5)) + scale_color_discrete(name = "Classes", labels = c("Class6", "Class5", "Class5", "Class3", "Class4", "Class8", "Class7", "Class4", "Class6", "Class1", "Class7", "Class3", "Class2", "Class1", "Class2", "Class8")) + geom_dl(aes(label = time_series_id), method = list(dl.combine("first.points", "last.points")), cex = 0.8)
ggplot(ex_class, aes(x=time_index, y=value, colour=time_series_id)) + geom_line() + xlab("Time Index") + ylab("Value") + theme(plot.title=element_text(hjust = 0.5)) + scale_color_discrete(name = "Classes", labels = c("Class6", "Class5", "Class5", "Class3", "Class4", "Class8", "Class7", "Class4", "Class6", "Class1", "Class7", "Class3", "Class2", "Class1", "Class2", "Class8"))
ggplot(ex_class, aes(x=time_index, y=value, colour=time_series_id)) + geom_line() + xlab("Time Index") + ylab("Value") + theme(plot.title=element_text(hjust = 0.5)) + scale_color_discrete(name = "Classes", labels = c("Class6", "Class5", "Class5", "Class3", "Class4", "Class8", "Class7", "Class4", "Class6", "Class1", "Class7", "Class3", "Class2", "Class1", "Class2", "Class8")) + geom_dl(aes(label = time_series_id), method = list(dl.combine("first.points", "last.points")), cex = 0.8)
ggplot(ex_class, aes(x=time_index, y=value, colour=time_series_id)) + geom_line() + xlab("Time Index") + ylab("Value") + theme(plot.title=element_text(hjust = 0.5)) + scale_color_discrete(name = "Classes", labels = c("Class6", "Class5", "Class5", "Class3", "Class4", "Class8", "Class7", "Class4", "Class6", "Class1", "Class7", "Class3", "Class2", "Class1", "Class2", "Class8")) + geom_dl(aes(label = class), method = list(dl.combine("first.points", "last.points")), cex = 0.8)
ggplot(ex_class, aes(x=time_index, y=value, colour=time_series_id)) + geom_line() + xlab("Time Index") + ylab("Value") + theme(plot.title=element_text(hjust = 0.5)) + scale_color_discrete(name = "Classes", labels = c("Class6", "Class5", "Class5", "Class3", "Class4", "Class8", "Class7", "Class4", "Class6", "Class1", "Class7", "Class3", "Class2", "Class1", "Class2", "Class8")) + geom_dl(aes(label = class), method = list(dl.combine("last.points")), cex = 0.8)
ex_class <- xyz_long_uni %>% filter(time_series_id %in% c(11, 17, 15, 20, 4, 13, 5, 8, 2, 3, 1, 10, 7, 12, 6, 21)) %>% mutate(time_series_id = as_factor(time_series_id), class = as_factor(class)) %>% group_by(class)
ggplot(ex_class, aes(x=time_index, y=value, colour=time_series_id)) + geom_line() + xlab("Time Index") + ylab("Value") + theme(plot.title=element_text(hjust = 0.5))
ggplot(ex_class, aes(x=time_index, y=value, colour=class)) + geom_line() + xlab("Time Index") + ylab("Value") + theme(plot.title=element_text(hjust = 0.5))
ggplot(ex_class) + geom_line(aes(x=time_index, y=value, colour=class)) + xlab("Time Index") + ylab("Value") + theme(plot.title=element_text(hjust = 0.5))
ggplot(ex_class) + geom_line(aes(x=time_index, y=value)) + xlab("Time Index") + ylab("Value") + theme(plot.title=element_text(hjust = 0.5))
ex_class <- xyz_long_uni %>% filter(time_series_id %in% c(11, 17, 15, 20, 4, 13, 5, 8, 2, 3, 1, 10, 7, 12, 6, 21)) %>% mutate(time_series_id = as_factor(time_series_id), class = as_factor(class))
ggplot(ex_class) + geom_line(aes(x=time_index, y=value)) + xlab("Time Index") + ylab("Value") + theme(plot.title=element_text(hjust = 0.5))
ggplot(ex_class, aes(x=time_index, y=value, colour=time_series_id)) + geom_line() + xlab("Time Index") + ylab("Value") + theme(plot.title=element_text(hjust = 0.5)) + scale_color_discrete(name = "Classes", labels = c("Class6", "Class5", "Class5", "Class3", "Class4", "Class8", "Class7", "Class4", "Class6", "Class1", "Class7", "Class3", "Class2", "Class1", "Class2", "Class8")) + geom_dl(aes(label = class), method = list(dl.combine("last.points")), cex = 0.8)
ggplot(ex_class) + geom_line(aes(x=time_index, y=value)) + xlab("Time Index") + ylab("Value") + theme(plot.title=element_text(hjust = 0.5))
ggplot(ex_class, aes(x=time_index, y=value, colour=time_series_id)) + geom_line() + xlab("Time Index") + ylab("Value") + theme(plot.title=element_text(hjust = 0.5)) + scale_color_discrete(name = "Classes", labels = c("Class6", "Class5", "Class5", "Class3", "Class4", "Class8", "Class7", "Class4", "Class6", "Class1", "Class7", "Class3", "Class2", "Class1", "Class2", "Class8")) + geom_dl(aes(label = class), method = list(dl.combine("last.points")), cex = 0.8)
ggplot(ex_class, aes(x=time_index, y=value, colour=class)) + geom_line() + xlab("Time Index") + ylab("Value") + theme(plot.title=element_text(hjust = 0.5)) + scale_color_discrete(name = "Classes")
install.packages(CVXR)
knitr::opts_chunk$set(echo = TRUE, conflict=FALSE, warning=FALSE, message=FALSE, error = FALSE, comment = FALSE)
library(CVXR)
install.packages("CVXR")
library(CVXR)
knitr::opts_chunk$set(echo = TRUE, conflict=FALSE, warning=FALSE, message=FALSE, error = FALSE, comment = FALSE)
library(caret) #createDataPartition
library(dplyr) # %>%
library(corrplot)
digits_test_raw <- read.csv("~/Desktop/projects/fall20-ilaydacelenk/files/HW4_data/digits_test", header=FALSE)
digits_train_raw <- read.csv("~/Desktop/projects/fall20-ilaydacelenk/files/HW4_data/digits_train", header=FALSE)
digits_train <- digits_train_raw
digits_test <- digits_test_raw
X_digits_train <- digits_train %>% select(-V65)
y_digits_train <- digits_train %>% select(V65)
X_digits_test <- digits_test %>% select(-V65)
y_digits_test <- digits_test %>% select(V65)
corrplot(cor(X_digits_train, method = c("spearman")))
corrplot(cor(X_digits_train, method = c("pearson")))
summary(digits_train)
View(digits_train)
digits_train <- digits_train_raw %>% select(-V1)
digits_test <- digits_test_raw %>% select(-V1)
View(digits_train)
X_digits_train <- digits_train %>% select(-V65)
y_digits_train <- digits_train %>% select(V65)
X_digits_test <- digits_test %>% select(-V65) %>% as.factor()
y_digits_test <- digits_test %>% select(V65) %>% as.factor()
corrplot(cor(X_digits_train, method = c("pearson")))
View(digits_train)
summary(X_digits_train)
digits_train <- digits_train_raw %>% select(-V1, -V40)
digits_test <- digits_test_raw %>% select(-V1, -V40)
X_digits_train <- digits_train %>% select(-V65)
y_digits_train <- digits_train %>% select(V65)
X_digits_test <- digits_test %>% select(-V65) %>% as.factor()
y_digits_test <- digits_test %>% select(V65) %>% as.factor()
corrplot(cor(X_digits_train, method = c("pearson")))
X_digits_train <- digits_train %>% select(-V65) %>% scale()
y_digits_train <- digits_train %>% select(V65) %>% as.factor()
X_digits_test <- digits_test %>% select(-V65) %>% scale()
y_digits_test <- digits_test %>% select(V65) %>% as.factor()
View(X_digits_test)
mushroom_raw <- read.csv("~/Desktop/projects/fall20-ilaydacelenk/files/HW4_data/mushroom",  header=FALSE)
View(mushroom_raw)
columns = c("class", "cap-shape", "cap-surface", "cap-color", "bruises", "odor", "gill-attachment", "gill-spacing", "gill-size",
"gill-color", "stalk-shape", "stalk-root", "stalk-surface-above-ring", "stalk-surface-below-ring", "stalk-color-above-ring",
"stalk-color-below-ring", "veil-type", "veil-color", "ring-number", "ring-type", "spore-print-color", "population", "habitat")
size(columns)
length(columns)
colnames(mushroom_raw) <- mushroom_colns
mushroom_colns <- c("class", "cap-shape", "cap-surface", "cap-color", "bruises", "odor", "gill-attachment", "gill-spacing", "gill-size",
"gill-color", "stalk-shape", "stalk-root", "stalk-surface-above-ring", "stalk-surface-below-ring", "stalk-color-above-ring",
"stalk-color-below-ring", "veil-type", "veil-color", "ring-number", "ring-type", "spore-print-color", "population", "habitat")
colnames(mushroom_raw) <- mushroom_colns
View(mushroom_raw)
summary(mushroom_raw)
mushroom_raw %>% n_distinct()
mushroom_raw %>% select(class) %>% n_distinct()
digits_train_raw %>% select(V65) %>% n_distinct()
mushroom_raw %>% group_by(class) %>% summarize(count=n())
mushroom_raw %>% group_by(class) %>% summarize(count=n())
View(mushroom_raw)
colnames(mushroom_raw) <- mushroom_colns
mushroom_raw %>% group_by(class) %>% summarize(count=n())
set.seed(50)
test_inds_mushroom = createDataPartition(y = 1:nrow(mushroom_raw), p = 0.2, list = F)
mushroom_train <- mushroom_raw[test_inds_mushroom, ]
mushroom_test <- mushroom_raw[-test_inds_mushroom, ]
X_mushroom_train <- mushroom_train %>% select(-class)
y_mushroom_train <- mushroom_train %>% select(class)
X_mushroom_test <- mushroom_test %>% select(-class)
y_mushroom_test <- mushroom_test %>% select(class)
rpart
library(rpart)
library(rpart)
DT_mushroom<-rpart(class~., data=X_mushroom_train)
X_mushroom_train <- mushroom_train %>% as.matrix()
DT_mushroom<-rpart(class~., data=X_mushroom_train)
X_mushroom_train <- mushroom_train %>% as.data.frame()
DT_mushroom<-rpart(class~., data=X_mushroom_train)
View(mushroom_train)
X_mushroom_test <- mushroom_test %>% as.data.frame()
DT_pred_mushroom<-predict(DT_mushroom, X_mushroom_test, type="class")
confusionMatrix(DT_pred_mushroom, X_mushroom_test$class)
n_distinct(DT_pred_mushroom)
length(DT_pred_mushroom)
n_distinct(X_mushroom_test$class)
length(X_mushroom_test$class)
confusionMatrix(DT_pred_mushroom, X_mushroom_test$class, na.action = na.pass)
DT_pred_mushroom<-predict(DT_mushroom, X_mushroom_test, type="class", na.action = na.pass)
confusionMatrix(DT_pred_mushroom, X_mushroom_test$class)
confusionMatrix(DT_pred_mushroom, X_mushroom_test$class)
DT_pred_mushroom<-predict(DT_mushroom, X_mushroom_test, type="class")
confusionMatrix(table(DT_pred_mushroom, X_mushroom_test$class))
confusionMatrix(data.frame(DT_pred_mushroom), data.frame(X_mushroom_test$class))
is.na(DT_mushroom)
is.na(mushroom_train)
sum(is.na(mushroom_train))
sum(is.na(mushroom_test))
DT_mushroom<-rpart(class~., data=X_mushroom_train)
DT_pred_mushroom<-predict(DT_mushroom, X_mushroom_test, type="class")
confusionMatrix(data.frame(DT_pred_mushroom), data.frame(X_mushroom_test$class))
DT_pred_mushroom
X_mushroom_test$class
confusionMatrix(DT_pred_mushroom, as.factor(X_mushroom_test$class))
confusionMatrix(as.factor(DT_pred_mushroom), as.factor(X_mushroom_test$class))
DT_pred_mushroom<-predict(DT_mushroom, X_mushroom_test, type="response")
DT_pred_mushroom<-predict(DT_mushroom, X_mushroom_test, type="class")
length(mushroom_train)
nrow(mushroom_train)
nrow(mushroom_test)
set.seed(50)
test_inds_mushroom = createDataPartition(y = 1:nrow(mushroom_raw), p = 0.8, list = F)
mushroom_train <- mushroom_raw[test_inds_mushroom, ]
mushroom_test <- mushroom_raw[-test_inds_mushroom, ]
X_mushroom_train <- mushroom_train %>% as.data.frame()
X_mushroom_test <- mushroom_test %>% as.data.frame()
DT_mushroom<-rpart(class~., data=X_mushroom_train)
DT_pred_mushroom<-predict(DT_mushroom, X_mushroom_test, type="class")
confusionMatrix(as.factor(DT_pred_mushroom), as.factor(X_mushroom_test$class))
install.packages('e1071', dependencies=TRUE)
confusionMatrix(as.factor(DT_pred_mushroom), as.factor(X_mushroom_test$class))
houseprice_test_raw <- read.csv("~/Desktop/projects/fall20-ilaydacelenk/files/HW4_data/house_price_test.csv")
houseprice_train_raw <- read.csv("~/Desktop/projects/fall20-ilaydacelenk/files/HW4_data/house_price_train.csv")
houseprice_test <- houseprice_test_raw
houseprice_train <- houseprice_train_raw
View(p)
View(houseprice_train_raw)
read.csv("~/Desktop/projects/fall20-ilaydacelenk/files/HW4_data/churn.csv")
churn_raw <- read.csv("~/Desktop/projects/fall20-ilaydacelenk/files/HW4_data/churn.csv")
set.seed(50)
train_inds_churn = createDataPartition(y = 1:nrow(churn_raw), p = 0.8, list = F)
churn_train <- churn_raw[train_inds_churn, ]
churn_test <- churn_raw[-train_inds_churn, ]
View(churn_test)
churn_raw %>% group_by(churn) %>% summary(count=n())
churn_raw %>% group_by(Churn) %>% summary(count=n())
churn_raw %>% select(Churn) %>% summary(count=n())
churn_raw %>% select(Churn) %>% group_by(Churn) %>% summary(count=n())
churn_raw %>% select(Churn) %>% n_distinct()
churn_raw %>% select(Churn=="Yes")
churn_raw %>% select(Churn=="Yes")
churn_raw %>% count(Churn=="Yes")
churn_raw %>% count(Churn)
length(churn_raw$Churn=="Yes")
nrow(churn_raw)
length(churn_raw$Churn=="No")
length(churn_raw$Churn="Yes")
summary(churn_raw$Churn)
churn_raw %>% distinct(Churn) %>% count()
churn_raw %>% group_by(Churn) %>% summarize(count=n())
churn_raw %>% filter(Churn=="Yes") %>% summarize(count=n())
print(churn_raw %>% filter(Churn=="Yes") %>% summarize(count=n()))
x<- churn_raw %>% filter(Churn=="Yes") %>% summarize(count=n())
x
View(x)
x[1,1]
y <- x[1,1]
y
z <- 5
count(churn_raw$Churn=="Yes")
n(churn_raw$Churn=="Yes")
length(churn_raw$Churn=="Yes")
x<-churn_raw$Churn=="Yes"
help(count_if)
imbalanceRatio(churn_raw,classAttr = "Churn")
library(imbalance)
install.packages("imbalance")
library(imbalance)
imbalanceRatio(churn_raw, class="Churn")
imbalanceRatio(churn_raw, class="Churn")*100
churn_raw %>% filter(Churn=="Yes") %>% summarize(count=n())
churn_raw %>% filter(Churn=="Yes") %>% count=n()
churn_raw %>% filter(Churn=="Yes") %>% count()
x <- churn_raw %>% filter(Churn=="Yes") %>% count()
as.integer(x)
x
as.numeric(x)
x
churn_raw %>% group_by(Churn) %>% summarize(count=n())
churn_raw %>% filter(Churn=="Yes") %>% summarize(churn_ratio=n()/nrow(churn_raw))
churn_raw %>% filter(Churn=="Yes") %>% summarize(100*churn_ratio=n()/nrow(churn_raw))
churn_raw %>% filter(Churn=="Yes") %>% summarize(churn_ratio=100*n()/nrow(churn_raw))
churn_raw %>% filter(Churn=="Yes") %>% summarize(churn_ratio=round(100*n()/nrow(churn_raw)))
digits_test_raw <- read.csv("~/Desktop/projects/fall20-ilaydacelenk/files/HW4_data/digits_test", header=FALSE)
digits_train_raw <- read.csv("~/Desktop/projects/fall20-ilaydacelenk/files/HW4_data/digits_train", header=FALSE)
digits_train <- digits_train_raw %>% select(-V1, -V40)
digits_test <- digits_test_raw %>% select(-V1, -V40)
X_digits_train <- digits_train %>% select(-V65) %>% scale()
y_digits_train <- digits_train %>% select(V65) %>% as.factor()
X_digits_test <- digits_test %>% select(-V65) %>% scale()
y_digits_test <- digits_test %>% select(V65) %>% as.factor()
#corrplot(cor(X_digits_train, method = c("pearson")))
digits_train <- cbind(as.data.table(X_digits_train), y_digits_train)
library(caret) #createDataPartition
library(dplyr) # %>%
library(corrplot)
library(DT)
#after scaling, we can bind them again
digits_train <- cbind(as.data.table(X_digits_train), y_digits_train)
#after scaling, we can bind them again
digits_train <- cbind(data.table(X_digits_train), y_digits_train)
library(data.table)
#after scaling, we can bind them again
digits_train <- cbind(as.data.table(X_digits_train), y_digits_train)
digits_test <- cbind(as.data.table(X_digits_test), y_digits_test)
predict_model_pra<-cv.glmnet(as.matrix(X_digits_train), y_digits_train, type.measure = "class", family="multinomial", nfolds=nFolds)
library(glmnet)
predict_model_pra<-cv.glmnet(as.matrix(X_digits_train), y_digits_train, type.measure = "class", family="multinomial", nfolds=nFolds)
predict_model_pra<-cv.glmnet(as.matrix(X_digits_train), y_digits_train, type.measure = "class", family="multinomial", nfolds=10)
length(y_digits_train)
nrow(y_digits_train)
type(y_digits_train)
typeof(y_digits_train)
typeof(X_digits_train)
digits_test <- cbind(as.data.table(X_digits_test), y_digits_test)
digits_test_raw <- read.csv("~/Desktop/projects/fall20-ilaydacelenk/files/HW4_data/digits_test", header=FALSE)
digits_train_raw <- read.csv("~/Desktop/projects/fall20-ilaydacelenk/files/HW4_data/digits_train", header=FALSE)
digits_train <- digits_train_raw %>% select(-V1, -V40)
digits_test <- digits_test_raw %>% select(-V1, -V40)
X_digits_train <- digits_train %>% select(-V65) %>% scale()
y_digits_train <- digits_train %>% select(V65) %>% as.factor()
X_digits_test <- digits_test %>% select(-V65) %>% scale()
y_digits_test <- digits_test %>% select(V65) %>% as.factor()
digits_test
View(digits_test)
y_digits_test <- digits_test %>% select(V65) %>% as.factor()
y_digits_test <- digits_test
y_digits_test <- digits_test %>% select(V65)
View(y_digits_test)
y_digits_test <- digits_test %>% select(V65) %>% as.factor()
y_digits_test <- digits_test %>% select(V65)
as.factor(y_digits_test)
View(y_digits_test)
View(X_digits_train)
X_digits_train <- digits_train %>% select(-V65) %>% scale()
y_digits_train <- digits_train %>% select(V65) %>% as.factor()
digits_train <- cbind(as.data.table(X_digits_train), y_digits_train)
digits_model_pra<-cv.glmnet(as.matrix(X_digits_train), y_digits_train, type.measure = "class", family="multinomial", nfolds=10)
nrow(y_digits_train)
nrow(X_digits_train)
View(X_digits_train)
View(digits_test)
digits_model_pra<-cv.glmnet(as.matrix(X_digits_train), digits_test$V65, type.measure = "class", family="multinomial", nfolds=10)
digits_model_pra<-cv.glmnet(as.matrix(X_digits_train), digits_train$V65, type.measure = "class", family="multinomial", nfolds=10)
digits_model_pra<-cv.glmnet(as.matrix(X_digits_train), digits_train$V65, type.measure = "class", family="multinomial", nfolds=10)
a<-digits_train$V65
b<-digits_test$V65
View(digits_train)
digits_test_raw <- read.csv("~/Desktop/projects/fall20-ilaydacelenk/files/HW4_data/digits_test", header=FALSE)
digits_train_raw <- read.csv("~/Desktop/projects/fall20-ilaydacelenk/files/HW4_data/digits_train", header=FALSE)
digits_train <- digits_train_raw %>% select(-V1, -V40)
digits_test <- digits_test_raw %>% select(-V1, -V40)
X_digits_train <- digits_train %>% select(-V65) %>% scale()
y_digits_train <- digits_train %>% select(V65) %>% as.factor()
X_digits_test <- digits_test %>% select(-V65) %>% scale()
y_digits_test <- digits_test %>% select(V65) %>% as.factor()
digits_train <- cbind(as.data.table(X_digits_train), y_digits_train)
digits_test <- cbind(as.data.table(X_digits_test), y_digits_test)
digits_test_raw <- read.csv("~/Desktop/projects/fall20-ilaydacelenk/files/HW4_data/digits_test", header=FALSE)
digits_train_raw <- read.csv("~/Desktop/projects/fall20-ilaydacelenk/files/HW4_data/digits_train", header=FALSE)
digits_train <- digits_train_raw %>% select(-V1, -V40)
digits_test <- digits_test_raw %>% select(-V1, -V40)
X_digits_train <- digits_train %>% select(-V65) %>% scale()
y_digits_train <- digits_train %>% select(V65) %>% as.factor()
X_digits_test <- digits_test %>% select(-V65) %>% scale()
y_digits_test <- digits_test %>% select(V65) %>% as.factor()
y_digits_train <- digits_train %>% select(V65) %>% as.factor()
y_digits_train <- 5
y_digits_train <- digits_train %>% select(V65) %>% as.factor()
View(digits_test)
digits_test <- digits_test_raw %>% select(-V1, -V40)
y_digits_test <- digits_test %>% select(V65) %>% as.factor()
y_digits_train <- digits_train %>% select(V65) %>% as.factor()
X_digits_train <- digits_train %>% select(-V65) %>% scale()
y_digits_train <- digits_train %>% select(V65)
X_digits_test <- digits_test %>% select(-V65) %>% scale()
y_digits_test <- digits_test %>% select(V65)
View(y_digits_test)
digits_train <- cbind(as.data.table(X_digits_train), y_digits_train)
digits_test <- cbind(as.data.table(X_digits_test), y_digits_test)
digits_train <- cbind(as.data.table(X_digits_train), as.factor(y_digits_train))
View(X_digits_train)
View(digits_train)
View(y_digits_test)
View(y_digits_train)
digits_test <- cbind(as.data.table(X_digits_test), y_digits_test)
View(digits_test)
digits_test <- cbind(as.data.table(X_digits_test), as.factor(y_digits_test))
digits_train <- cbind(as.data.table(X_digits_train), y_digits_train)
digits_test <- cbind(as.data.table(X_digits_test), y_digits_test)
View(digits_train)
digits_train$V65
factor(digits_train$V65)
as.factor(digits_train$V65)
digits_train <- cbind(as.data.table(X_digits_train), y_digits_train) %>% mutate(V65=as.factor(V65))
digits_test <- cbind(as.data.table(X_digits_test), y_digits_test) %>% mutate(V65=as.factor(V65))
